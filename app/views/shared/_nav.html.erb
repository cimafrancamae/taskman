<div data-controller="reveal" data-reveal-hidden-class="d-none">
  <!-- Header Navigation -->
  <nav class="fixed top-0 z-40 w-full bg-indigo-100 border-b border-gray-200 dark:bg-gray-800 dark:border-gray-700">
    <div class="px-3 py-3 lg:px-5 lg:pl-3">
      
      <!-- Header Nav Icons Wrapper -->
      <div class="flex items-center justify-between">
        
        <!-- Left Side Buttons -->
        <div class="flex items-center justify-start rtl:justify-end">

          <!-- Button to hide sidebar -->
          <button 
            data-action="click->reveal#toggle" 
            data-drawer-target="nav_sidebar"
            data-drawer-toggle="nav_sidebar"
            aria-controls="nav_sidebar"
            type="button"
            class="text-gray-900 mr-6">
            <svg 
              class="w-6 h-6" 
              fill="none" 
              stroke="currentColor" 
              viewBox="0 0 24 24" 
              xmlns="http://www.w3.org/2000/svg">
              <path 
                stroke-linecap="round" 
                stroke-linejoin="round" 
                stroke-width="2" 
                d="M4 6h16M4 12h16m-7 6h7">
              </path>
            </svg>
          </button>
          
          <!-- Create tasks and categories Button -->
          <div class="flex mr-6" data-controller="reveal">
            <button 
              data-dropdown-toggle="dropdown-create" 
              type="button" 
              class="border border-red-700 rounded-3xl pr-2 py-1 inline-flex items-center gap-x-1 text-sm font-semibold  leading-6 text-red-700 hover:bg-red-200" 
              aria-expanded="false">
              <svg 
                class="w-6 h-6 text-red-700 dark:text-white" 
                aria-hidden="true" 
                xmlns="http://www.w3.org/2000/svg" 
                fill="currentColor" 
                viewBox="0 0 24 24">
                <path 
                  fill-rule="evenodd" 
                  d="M2 12a10 10 0 1 1 20 0 10 10 0 0 1-20 0Zm11-4.2a1 1 0 1 0-2 0V11H7.8a1 1 0 1 0 0 2H11v3.2a1 1 0 1 0 2 0V13h3.2a1 1 0 1 0 0-2H13V7.8Z" 
                  clip-rule="evenodd"/>
              </svg>
              <span>Create</span>
            </button>
            
            <!-- Create Buttons Card -->
            <div 
              id="dropdown-create" 
              class="absolute z-50 mt-10 flex px-4 hidden"
              data-reveal-target="item">
              <div class="flex-auto overflow-hidden rounded-3xl bg-white text-sm leading-6 shadow-sm ring-1 ring-gray-900/5">  
                <div class="p-4">

                  <!-- Create New Task Row -->
                  <div class="group relative flex gap-x-6 rounded-lg p-4 hover:bg-gray-50">
                    <div class="mt-1 flex h-11 w-11 flex-none items-center justify-center rounded-lg bg-gray-50 group-hover:bg-white">
                      <svg 
                        class="h-6 w-6 text-gray-600 group-hover:text-indigo-600" 
                        fill="none" 
                        viewBox="0 0 24 24" 
                        stroke-width="1.5" 
                        stroke="currentColor" 
                        aria-hidden="true">
                        <path d="M17.1 12.6v-1.8A5.4 5.4 0 0 0 13 5.6V3a1 1 0 0 0-2 0v2.4a5.4 5.4 0 0 0-4 5.5v1.8c0 2.4-1.9 3-1.9 4.2 0 .6 0 1.2.5 1.2h13c.5 0 .5-.6.5-1.2 0-1.2-1.9-1.8-1.9-4.2ZM6 6a1 1 0 0 1-.7-.3l-1-1a1 1 0 0 1 1.4-1.4l1 1A1 1 0 0 1 6 6Zm-2 4H3a1 1 0 0 1 0-2h1a1 1 0 1 1 0 2Zm14-4a1 1 0 0 1-.7-1.7l1-1a1 1 0 1 1 1.4 1.4l-1 1a1 1 0 0 1-.7.3Zm3 4h-1a1 1 0 1 1 0-2h1a1 1 0 1 1 0 2ZM8.8 19a3.5 3.5 0 0 0 6.4 0H8.8Z"/>
                      </svg>
                    </div>

                    <!-- Create New Task Turbo Frame -->
                      <div>
                        <%= link_to "Task", new_task_path, data: { turbo_frame: "data_task_frame", action: "click->reveal#hide" }, class: "font-semibold text-gray-900" %>
                        <p class="mt-1 text-gray-600">Create new task</p>
                      </div>
                  </div>

                  <!-- Create New Category Row -->
                  <div class="group relative flex gap-x-6 rounded-lg p-4 hover:bg-gray-50">
                    <div class="mt-1 flex h-11 w-11 flex-none items-center justify-center rounded-lg bg-gray-50 group-hover:bg-white">
                      <svg 
                        class="h-6 w-6 text-gray-600 group-hover:text-indigo-600" 
                        fill="none" 
                        viewBox="0 0 24 24" 
                        stroke-width="1.5" 
                        stroke="currentColor" 
                        aria-hidden="true">
                        <path fill-rule="evenodd" d="M4.9 3C3.9 3 3 3.8 3 4.9V9c0 1 .8 1.9 1.9 1.9H9c1 0 1.9-.8 1.9-1.9V5c0-1-.8-1.9-1.9-1.9H5Zm10 0c-1 0-1.9.8-1.9 1.9V9c0 1 .8 1.9 1.9 1.9H19c1 0 1.9-.8 1.9-1.9V5c0-1-.8-1.9-1.9-1.9h-4Zm-10 10c-1 0-1.9.8-1.9 1.9V19c0 1 .8 1.9 1.9 1.9H9c1 0 1.9-.8 1.9-1.9v-4c0-1-.8-1.9-1.9-1.9H5Zm10 0c-1 0-1.9.8-1.9 1.9V19c0 1 .8 1.9 1.9 1.9H19c1 0 1.9-.8 1.9-1.9v-4c0-1-.8-1.9-1.9-1.9h-4Z" clip-rule="evenodd"/>
                      </svg>
                    </div>

                    <!-- Create New Category Link -->
                    <div>
                      <%= link_to "Category", new_category_path, data: { action: "click->reveal#hide" }, class: "font-semibold text-gray-900" %>
                      <p class="mt-1 text-gray-600">Create new category</p>
                    </div>

                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- User Menu -->
        <div class="flex items-center">
          <div class="flex items-center ms-3">
            
            <!-- User Menu Button -->
            <div>
              <button 
                type="button" 
                class="flex text-sm bg-gray-800 rounded-full focus:ring-4 focus:ring-gray-300 dark:focus:ring-gray-600" 
                aria-expanded="false" 
                data-dropdown-toggle="dropdown-user">
                  <span class="sr-only">Open user menu</span>
                  <img class="w-8 h-8 rounded-full" src="https://static.vecteezy.com/system/resources/previews/002/002/257/non_2x/beautiful-woman-avatar-character-icon-free-vector.jpg" alt="user photo">
              </button>
            </div>

            <!-- Menu Card -->
            <div 
              class="z-50 hidden my-4 text-base list-none bg-white divide-y divide-gray-100 rounded shadow dark:bg-gray-700 dark:divide-gray-600" 
              id="dropdown-user">
              <div class="px-4 py-3" role="none">
                <p class="text-sm text-gray-900 dark:text-white">
                  <%= current_user.email %>
                </p>
              </div>
              <ul class="py-1" role="none">
                <!-- Signout Link -->
                <li>
                  <%= link_to "Sign out", 
                    destroy_user_session_path, 
                    data: { turbo_method: :delete }, 
                    class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-600 dark:hover:text-white" %>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Sidebar Navigation -->
  <aside 
    data-reveal-target="item" 
    id="nav_sidebar"
    class="d-none fixed top-0 left-0  w-64 h-screen pt-20 transition-transform -translate-x-full bg-indigo-100 border-r border-gray-200 sm:translate-x-0 dark:bg-gray-800 dark:border-gray-700" >
    <div class="h-full px-3 pb-4 overflow-y-auto bg-indigo-100 dark:bg-gray-800">
      <ul class="space-y-2 font-medium text-sm">
          
        <!-- Home Button -->
        <li>
          <div class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group">
            <svg 
              class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white" 
              aria-hidden="true" 
              xmlns="http://www.w3.org/2000/svg" 
              fill="currentColor" 
              viewBox="0 0 24 24">
                <path 
                  fill-rule="evenodd" 
                  d="M11.3 3.3a1 1 0 0 1 1.4 0l6 6 2 2a1 1 0 0 1-1.4 1.4l-.3-.3V19a2 2 0 0 1-2 2h-3a1 1 0 0 1-1-1v-3h-2v3c0 .6-.4 1-1 1H7a2 2 0 0 1-2-2v-6.6l-.3.3a1 1 0 0 1-1.4-1.4l2-2 6-6Z" 
                  clip-rule="evenodd"/>
            </svg>
            <span class="ms-3">
              <%= link_to "Home", root_path %>
            </span>
          </div>
        </li>

        <!-- Tasks Due Today -->
        <li>
          <div class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group">
            <svg 
              class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white" 
              aria-hidden="true" 
              xmlns="http://www.w3.org/2000/svg" 
              fill="currentColor" 
              viewBox="0 0 20 20">
              <path d="M17.1 12.6v-1.8A5.4 5.4 0 0 0 13 5.6V3a1 1 0 0 0-2 0v2.4a5.4 5.4 0 0 0-4 5.5v1.8c0 2.4-1.9 3-1.9 4.2 0 .6 0 1.2.5 1.2h13c.5 0 .5-.6.5-1.2 0-1.2-1.9-1.8-1.9-4.2ZM6 6a1 1 0 0 1-.7-.3l-1-1a1 1 0 0 1 1.4-1.4l1 1A1 1 0 0 1 6 6Zm-2 4H3a1 1 0 0 1 0-2h1a1 1 0 1 1 0 2Zm14-4a1 1 0 0 1-.7-1.7l1-1a1 1 0 1 1 1.4 1.4l-1 1a1 1 0 0 1-.7.3Zm3 4h-1a1 1 0 1 1 0-2h1a1 1 0 1 1 0 2ZM8.8 19a3.5 3.5 0 0 0 6.4 0H8.8Z"/>
            </svg>
            <span >
              <%= link_to "Tasks Due Today", tasks_path(tasks_today: true), class: "flex-1 ms-3 whitespace-nowrap" %>
            </span>

            <!-- Tasks Due Today Count -->
            <span class="inline-flex items-center justify-center w-3 h-3 p-3 ms-3 text-sm font-medium text-red-800 bg-red-200 rounded-full dark:bg-blue-900 dark:text-blue-300">
              <span id="nav_today_count"><%= @tasks_today.count %></span>
            </span>
          </div>
        </li>

        <!-- My Tasks Button -->
        <li>
          <div class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group">
            <svg 
              class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white" 
              aria-hidden="true" 
              xmlns="http://www.w3.org/2000/svg" 
              fill="currentColor" 
              viewBox="0 0 24 24">
              <path 
                fill-rule="evenodd" 
                d="M8 3c0-.6.4-1 1-1h6c.6 0 1 .4 1 1h2a2 2 0 0 1 2 2v15a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2h2Zm6 1h-4v2H9a1 1 0 0 0 0 2h6a1 1 0 1 0 0-2h-1V4Zm-3 8c0-.6.4-1 1-1h3a1 1 0 1 1 0 2h-3a1 1 0 0 1-1-1Zm-2-1a1 1 0 1 0 0 2 1 1 0 1 0 0-2Zm2 5c0-.6.4-1 1-1h3a1 1 0 1 1 0 2h-3a1 1 0 0 1-1-1Zm-2-1a1 1 0 1 0 0 2 1 1 0 1 0 0-2Z" 
                clip-rule="evenodd"/>
            </svg>
            <span class="ms-3"><%= link_to "My Tasks", tasks_path %></span>
          </div>
        </li>
        
        <!-- Categories Dropdown -->
        <li>
          <div class="border-t border-gray-300 mx-4 mt-10 mb-4"></div>
          <button 
            type="button" 
            class="flex items-center w-full p-2 text-base text-gray-900 transition duration-75 rounded-lg group hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700" 
            aria-controls="dropdown-categories" 
            data-collapse-toggle="dropdown-categories">
            <svg 
              class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 group-hover:text-gray-900 dark:text-gray-400 dark:group-hover:text-white" 
              aria-hidden="true" 
              xmlns="http://www.w3.org/2000/svg" 
              fill="currentColor" 
              viewBox="0 0 18 21">
                <path 
                  fill-rule="evenodd" 
                  d="M4.9 3C3.9 3 3 3.8 3 4.9V9c0 1 .8 1.9 1.9 1.9H9c1 0 1.9-.8 1.9-1.9V5c0-1-.8-1.9-1.9-1.9H5Zm10 0c-1 0-1.9.8-1.9 1.9V9c0 1 .8 1.9 1.9 1.9H19c1 0 1.9-.8 1.9-1.9V5c0-1-.8-1.9-1.9-1.9h-4Zm-10 10c-1 0-1.9.8-1.9 1.9V19c0 1 .8 1.9 1.9 1.9H9c1 0 1.9-.8 1.9-1.9v-4c0-1-.8-1.9-1.9-1.9H5Zm10 0c-1 0-1.9.8-1.9 1.9V19c0 1 .8 1.9 1.9 1.9H19c1 0 1.9-.8 1.9-1.9v-4c0-1-.8-1.9-1.9-1.9h-4Z" 
                  clip-rule="evenodd"/>
            </svg>
            <span class="flex-1 ms-3 text-sm font-semibold text-left rtl:text-right whitespace-nowrap">
              Categories
            </span>
            <svg 
              class="w-3 h-3" 
              aria-hidden="true" 
              xmlns="http://www.w3.org/2000/svg" 
              fill="none" 
              viewBox="0 0 10 6">
              <path 
                stroke="currentColor" 
                stroke-linecap="round" 
                stroke-linejoin="round" 
                stroke-width="2" d="m1 1 4 4 4-4"/>
            </svg>
          </button>

          <!-- Display Categories -->
          <ul id="dropdown-categories" class="py-2 space-y-2">
            <% @categories.each do |category| %>
              <li>
                <%= link_to category.name.capitalize, 
                  category_path(category), 
                  class: "flex items-center w-full p-2 text-gray-900 transition duration-75 rounded-lg pl-11 group hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700" %>
                </li>
            <% end %>
          </ul>
        </li>

        <!-- Sign out Button -->
        <li>
          <div class="border-t border-gray-300 mx-4 mt-10 mb-4"></div>
            <div class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group">
              <svg 
                class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white" 
                aria-hidden="true" 
                xmlns="http://www.w3.org/2000/svg" 
                fill="none" 
                viewBox="0 0 18 16">
                <path 
                  stroke="currentColor" 
                  stroke-linecap="round" 
                  stroke-linejoin="round" 
                  stroke-width="2" d="M1 8h11m0 0L8 4m4 4-4 4m4-11h3a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-3"/>
              </svg>
              <%= link_to "Sign out", destroy_user_session_path, data: { turbo_method: :delete }, class: "block px-3" %>
            </div>
          </div>
        </li>
      </ul>
    </div>
  </aside>
</div>